name: sync
on:
  schedule:
  - cron: '* */6 * * *'
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]
jobs:
  build:
    runs-on: ubuntu-latest
    container: quay.io/skopeo/stable:latest
    continue-on-error: true
    strategy:
    #  max-parallel: 10
     matrix:
        syncs:


    steps:
    - name: Checkout
      uses: actions/checkout@v2
    - name: 'login'
      run: skopeo login -u ${{ secrets.REGISTERY_USERNAME }} registry.cn-hangzhou.aliyuncs.com -p "${{ secrets.REGISTERY_PASSWORD }}"
    - name: 'pare'
      run: |
        dnf install pip3 -y 
        pip3 install redis
    - name: sync
      run: REDIS_HOST="${{ secrets.REDIS_HOST }}" REDIS_PASSWORD="${{ secrets.REDIS_PASSWORD }}" python3 sync.py ${{ matrix.syncs }} -v

