name: sync
on:
  schedule:
  - cron: '*/10 * * * *'
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]
jobs:
  build:
    runs-on: ubuntu-latest
    container: debian:stable
    strategy:
    #  max-parallel: 10
     matrix:
        syncs:
          - 'ghcr.io/prometheus-operator/prometheus-config-reloader'
          - 'docker.io/istio/examples-bookinfo-details-v1'
          - 'docker.io/istio/examples-bookinfo-reviews-v1'
          - 'docker.io/istio/tcp-echo-server'
          - 'docker.io/istio/health'
          - 'docker.io/grafana/loki'
          - 'docker.io/kiwigrid/k8s-sidecar'
          - 'docker.io/grafana/grafana'
          - 'docker.io/istio/examples-bookinfo-reviews-v2'
          - 'docker.io/mccutchen/go-httpbin'
          - 'docker.io/istio/proxyv2'
          - 'docker.io/istio/examples-bookinfo-mongodb'
          - 'docker.io/istio/examples-bookinfo-ratings-v1'
          - 'docker.io/istio/examples-helloworld-v1'
          - 'docker.io/istio/examples-helloworld-v2'
          - 'docker.io/istio/examples-bookinfo-details-v2'
          - 'docker.io/jaegertracing/all-in-one'
          - 'docker.io/istio/examples-bookinfo-reviews-v3'
          - 'docker.io/istio/examples-bookinfo-productpage-v1'
          - 'docker.io/istio/examples-bookinfo-ratings-v2'
          - 'docker.io/istio/examples-bookinfo-mysqldb'

          - 'docker.io/projecthami/hami'
          - 'docker.io/clickhouse/clickhouse-server'
          - 'ghcr.io/eunomia-bpf/ecc-x86_64'
          - 'docker.io/opensearchproject/opensearch'
          - 'docker.io/opensearchproject/opensearch-dashboards'
          - 'docker.io/meltwater/latency-test'
          - 'quay.io/cilium/hubble-export-stdout'
          - 'quay.io/cilium/tetragon-operator'
          - 'quay.io/cilium/tetragon'
          - 'quay.io/cilium/certgen'
          - 'quay.io/cilium/hubble-ui-backend'
          - 'quay.io/cilium/hubble-ui'
          - 'quay.io/cilium/cilium-envoy'
          - 'quay.io/cilium/operator'
          - 'quay.io/cilium/startup-script'
          - 'quay.io/cilium/operator-generic'
          - 'docker.io/cilium/hubble-relay'
          - 'docker.io/cilium/cilium'

          - 'ghcr.io/protosam/auto-nbd'
          - 'docker.io/rook/ceph'
          - 'quay.io/cephcsi/cephcsi'
          - 'k8s.gcr.io/sig-storage/csi-node-driver-registrar'
          - 'k8s.gcr.io/sig-storage/csi-resizer'
          - 'k8s.gcr.io/sig-storage/csi-provisioner'
          - 'k8s.gcr.io/sig-storage/csi-snapshotter'
          - 'k8s.gcr.io/sig-storage/csi-attacher'
          - 'docker.io/flomesh/pipy'
          - 'docker.io/flomesh/pipy-repo'
          - 'docker.io/flomesh/fsm-sidecar-init'
          - 'docker.io/flomesh/fsm-preinstall'
          - 'docker.io/flomesh/fsm-bootstrap'
          - 'docker.io/flomesh/fsm-controller'
          - 'docker.io/flomesh/fsm-injector'
          - 'docker.io/flomesh/fsm-ingress'
          - 'docker.io/flomesh/fsm-curl'
          - 'docker.io/rancher/k3s'
          - 'docker.io/library/busybox'
          - 'docker.io/kubeshark/front'
          - 'docker.io/kubeshark/worker'
          - 'docker.io/kubeshark/hub'
          - 'quay.io/submariner/lighthouse-agent'
          - 'quay.io/submariner/nettest'
          - 'quay.io/submariner/submariner-operator'
          - 'quay.io/submariner/lighthouse-coredns'
          - 'quay.io/submariner/submariner-gateway'
          - 'quay.io/submariner/submariner-route-agent'
          - 'docker.io/karmada/karmada-metrics-adapter'
          - 'docker.io/karmada/karmada-operator'
          - 'docker.io/karmada/karmada-search'
          - 'docker.io/karmada/karmada-interpreter-webhook-example'
          - 'docker.io/karmada/karmada-scheduler-estimator'
          - 'docker.io/karmada/karmada-agent'
          - 'docker.io/karmada/karmada-webhook'
          - 'docker.io/karmada/karmada-descheduler'
          - 'docker.io/karmada/karmada-scheduler'
          - 'docker.io/karmada/karmada-controller-manager'
          - 'docker.io/karmada/karmada-aggregated-apiserver'
          - 'docker.io/wagoodman/dive'
          - 'docker.io/mingrammer/flog'
          - 'docker.io/kubeskoop/agent'
          - 'docker.io/prom/prometheus'
          - 'docker.io/kubeskoop/controller'
          - 'docker.io/loftsh/vcluster'
          - 'ghcr.io/k-cloud-labs/kinitiras-webhook'
          - 'docker.io/goharbor/prepare'
          - 'docker.io/vllm/vllm-openai'
          - 'docker.io/library/nginx'
          - 'registry.k8s.io/etcd'
          - 'registry.k8s.io/kube-apiserver'
          - 'registry.k8s.io/kube-controller-manager'
          - 'registry.k8s.io/metrics-server/metrics-server'
          - 'docker.io/80imike/find-container-process'
          - 'gcr.io/heptio-images/ks-guestbook-demo'
          - 'docker.io/budtmo/docker-android'
          - 'docker.io/x11docker/xserver-xorg-focal'
          - 'docker.io/yunwei37/ebpm'
          - 'docker.io/redroid/redroid'
          - 'docker.io/volcanosh/dist-mnist-tf-example'
          - 'docker.io/volcanosh/vc-webhook-manager'
          - 'docker.io/volcanosh/vc-controller-manager'
          - 'docker.io/volcanosh/vc-scheduler'
          - 'docker.io/library/alpine'
          - 'docker.io/labring/kubernetes-docker'
          - 'docker.io/labring/kubernetes'
          - 'docker.io/labring/helm'
          - 'docker.io/labring/flannel'
          - 'docker.io/labring/calico'
          - 'docker.io/library/ubuntu'
          - 'docker.io/library/redis'
          - 'docker.io/library/centos'
          - 'docker.io/mydlqclub/dnsutils'
          - 'docker.io/apache/apisix'
          - 'docker.io/flannel/flannel-cni-plugin'
          - 'docker.io/flannel/flannel'
          - 'docker.io/library/debian'
          - 'skywalking.docker.scarf.sh/apache/skywalking-oap-server'
          - 'skywalking.docker.scarf.sh/apache/skywalking-ui'
          - 'docker.io/library/busybox'
          - 'docker.elastic.co/elasticsearch/elasticsearch'
          - 'quay.io/jetstack/cert-manager-ctl'
          - 'ghcr.io/apache/skywalking-showcase/load-gen'
          - 'ghcr.io/apache/skywalking-showcase/recommendation-service'
          - 'docker.io/apache/rocketmq-exporter'
          - 'ghcr.io/apache/skywalking-showcase/gateway-service'
          - 'ghcr.io/apache/skywalking/ui'
          - 'docker.io/rmohr/activemq'
          - 'docker.io/grafana/grafana'
          - 'quay.io/prometheuscommunity/elasticsearch-exporter'
          - 'docker.io/prometheuscommunity/postgres-exporter'
          - 'quay.io/jetstack/cert-manager-webhook'
          - 'docker.io/bitnami/kubectl'
          - 'docker.elastic.co/elasticsearch/elasticsearch'
          - 'docker.io/bitnami/mongodb'
          - 'ghcr.io/apache/skywalking-showcase/app'
          - 'docker.io/library/postgres'
          - 'docker.io/library/golang'
          - 'ghcr.io/apache/skywalking-showcase/songs-service'
          - 'docker.io/pivotalrabbitmq/perf-test'
          - 'ghcr.io/skyapm/r3'
          - 'docker.io/apache/skywalking-swck'
          - 'ghcr.io/apache/skywalking-satellite/skywalking-satellite'
          - 'docker.io/library/mysql'
          - 'docker.io/apache/rocketmq'
          - 'ghcr.io/apache/skywalking-kubernetes-event-exporter/skywalking-kubernetes-event-exporter'
          - 'docker.io/openresty/openresty'
          - 'gcr.io/kubebuilder/kube-rbac-proxy'
          - 'docker.io/fluent/fluent-bit'
          - 'quay.io/prometheus/node-exporter'
          - 'docker.io/bitnami/mongodb-exporter'
          - 'docker.io/curlimages/curl'
          - 'docker.io/apachepulsar/pulsar-all'
          - 'docker.io/prom/mysqld-exporter'
          - 'ghcr.io/apache/skywalking/oap'
          - 'ghcr.io/apache/skywalking-showcase/frontend'
          - 'quay.io/jetstack/cert-manager-controller'
          - 'docker.io/bitnami/jmx-exporter'
          - 'ghcr.io/apache/skywalking-showcase/rating-service'
          - 'docker.io/otel/opentelemetry-collector'
          - 'ghcr.io/apache/skywalking-rover/skywalking-rover'
          - 'ghcr.io/apache/skywalking-cli/skywalking-cli'
          - 'registry.k8s.io/kube-state-metrics/kube-state-metrics'
          - 'docker.io/bitnami/rabbitmq'
          - 'docker.io/kindest/node'
          - 'docker.io/frooodle/s-pdf'
          - 'docker.io/library/python'
          - 'public.ecr.aws/zinclabs/openobserve'

          - 'docker.io/kubezoo/kubezoo'
          - 'docker.io/kubezoo/clusterresourcequota'

    steps:
    - name: Checkout
      uses: actions/checkout@v2
    - name: 'update'
      run: apt update -y && apt -y install skopeo curl python3
    - name: 'login'
      run: skopeo login -u ${{ secrets.REGISTERY_USERNAME }} registry.cn-hangzhou.aliyuncs.com -p "${{ secrets.REGISTERY_PASSWORD }}"
    - name: sync
      run: python3 sync.py ${{ matrix.syncs }} -v

